"use strict";!function(t){function e(a){function i(e){var s=[],a=o.$boxs.find(".checked");a.each(function(e,a){s.push({id:t(a).data("id"),name:t(a).text()})}),n=s,s=s.concat(c.get());var i=r(s);e.html(i)}function r(t){for(var e="",s=0;s<t.length;s++)e+="<a data-id='"+t[s].id+"' href='javascript:;'>"+t[s].name+"<em class='del'></em></a>";return e}var c,n=[];s++;var l={targetEle:"body",data:[]};this.opts=t.extend(l,a),this.$wrap=t("<div class='target-picker-wrap target-picker-"+s+"'></div>"),this.$navs=t("<div class='target-picker-navs'></div>"),this.$boxs=t("<div class='target-picker-boxs'></div>"),this.$custom=t("<form class='target-picker-custom'><input class='inp-custom-place' type='text' placeholder='其他地方' /><button class='mu-btn mu-btn-s mu-btn-brown' type='submit'>添加</button></form>"),this.$result=t("<div class='check-result'></div>");var o=this;this.$wrap.append(this.$navs,this.$boxs,this.$custom,this.$result),t(this.opts.targetEle).append(this.$wrap);for(var u="",d="",h=0;h<this.opts.data.length;h++){var v=this.opts.data[h];u+="<a class='"+(0===h?" curr":"")+"' href='javascript:;'>"+v.name+"</a>",d+="<div class='box-item"+(0===h?" curr":"")+"'>";for(var p=0;p<v.citys.length;p++)d+="<a data-id='item-"+h+p+"' href='javascript:;'>"+v.citys[p].name+"</a>";d+="</div>"}c=function(){function e(t){return t.replace(/(^\s*)|(\s*$)/g,"")}function s(s){s=e(s);var a=t.grep(r,function(t){return t.name===s});if(a.length)return!1;var i={id:"custom"+c++,name:s};r.push(i)}function a(t){for(var e=0;e<r.length;e++)if(r[e].name===t){r.splice(e,1);break}}function i(){return r}var r=[],c=0;return{add:s,del:a,get:i}}(),this.$boxs.delegate("a","click",function(){t(this).toggleClass("checked"),i(o.$result)}),this.$result.delegate(".del","click",function(){var e=t(this).parent().data("id"),s=t(this).parent().text();/^custom/.test(e)?(c.del(s),i(o.$result)):o.$boxs.find("[data-id="+e+"]").trigger("click")}),this.$custom.on("submit",function(){var e=t(this).find(".inp-custom-place"),s=e.val();return c.add(s),i(o.$result),e.val("").focus(),!1}),e.prototype.getResult=function(){return n.concat(c.get())},this.$navs.html(u),this.$boxs.append(d),t.fn.tabSwitch=function(e){var s={liSelcter:".w_tab_names li",boxSelecter:".w_tab_boxs .box",liActiveClass:"cur",boxActiveClass:"cur",callback:t.noop};return e&&t.extend(s,e),this.each(function(){var e=this;t(this).find(s.liSelcter).each(function(a){t(this).click(function(){t(this).addClass(s.liActiveClass).siblings().removeClass(s.liActiveClass),t(e).find(s.boxSelecter).eq(a).addClass(s.boxActiveClass).siblings().removeClass(s.boxActiveClass),s.callback(t(this),t(e).find(s.boxSelecter).eq(a))})})})},this.$wrap.tabSwitch({liSelcter:".target-picker-navs a",boxSelecter:".target-picker-boxs .box-item",liActiveClass:"curr",boxActiveClass:"curr"})}var s=0;window.TargetPicker=e}(window.$);